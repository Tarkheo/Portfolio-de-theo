<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lettre de Motivation</title>
  <link rel="stylesheet" href="css/stylemotivation.css">
  <!-- Biblioth√®que jsPDF pour g√©n√©rer des PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
  
  <!-- Bouton retour style Matrix en haut √† gauche -->
  <a href="javascript:history.back()" class="btn-matrix">‚Üê Retour</a>

  <!-- Conteneur principal de la lettre -->
  <div class="letter-container">
    <!-- Papier blanc de la lettre -->
    <div class="letter-paper" id="letterContent">
      
      <!-- En-t√™te avec vos coordonn√©es -->
      <div class="sender-info">
        <p><strong>Th√©o Dautrevaux</strong></p>
        <p>Ville de r√©sidence : Roye</p>
        <p>Email : todtvx@protonmail.com</p>
      </div>

      <!-- Coordonn√©es du destinataire -->
      <div class="recipient-info">
        <p><strong>Bonduelle</strong></p>
        <p>√Ä l'attention de M./Mme</p>
        <p>Service Ressources Humaines</p>
        <p>Bonduelle - Estr√©es-Mons</p>
        <p>80200</p>
      </div>

      <!-- Lieu et date -->
      <div class="date-location">
        <p>Amiens, le <span id="current-date"></span></p>
      </div>

      <!-- Objet de la lettre -->
      <div class="object">
        <p><strong>Objet :</strong> Candidature au poste de Stagiaire Technicien syst√®me et r√©seaux</p>
      </div>

      <!-- Formule d'appel -->
      <div class="greeting">
        <p>Madame, Monsieur,</p>
      </div>

      <!-- Corps de la lettre -->
      <div class="letter-body">
        <p>
          Actuellement √† la recherche d'un stage, je me permets de vous adresser ma candidature 
          pour le poste de technicien syst√®me et r√©seau au sein de votre entreprise Bonduelle entreprise.
        </p>

        <p>
          Dipl√¥m√© d'un Baccalaur√©at option Maths / Informatique et d'une exp√©rience de 1mois dans le domaine 
          de informatique, j'ai d√©velopp√© des comp√©tences solides en d√©veloppement, 
          en r√©seau gr√¢ce √† cisco. Mon parcours m'a permis d'acqu√©rir une expertise 
          particuli√®re en syst√®me et r√©saeau, ce qui correspond parfaitement aux exigences 
          du poste que vous proposez.
        </p>

        <p>
          Au cours de mes pr√©c√©dentes exp√©riences chez Chantelle Corbie, j'ai eu 
          l'occasion de d√©couvrir le monde du r√©seau avec GPAO.
        </p>

        <p>
          Votre entreprise attire particuli√®rement mon attention pour elle pourrait m'apporter de r√©√©lles comp√©tences en syst√®me et r√©seaux. Je suis convaincu que mes 
          comp√©tences et ma motivation contribueront au d√©veloppement de vos projets et 
          aux objectifs de votre structure.
        </p>

        <p>
          Je reste √† votre disposition pour un entretien afin de vous exposer plus en d√©tail 
          mes motivations et ma vision du poste. Dans cette attente, je vous prie d'agr√©er, 
          Madame, Monsieur, l'expression de mes salutations distingu√©es.
        </p>
      </div>

      <!-- Signature -->
      <div class="signature">
        <p>Th√©o Dautrevaux</p>
      </div>

    </div>
  </div>

  <!-- Section boutons -->
  <div class="action-buttons">
    <button onclick="visualiserPDF()" class="btn-action btn-visualiser">
      üëÅÔ∏è Visualiser en PDF
    </button>
    <button onclick="telechargerPDF()" class="btn-action btn-telecharger">
      üì• T√©l√©charger en PDF
    </button>
    <button onclick="imprimerLettre()" class="btn-action btn-imprimer">
      üñ®Ô∏è Imprimer
    </button>
  </div>

  <!-- Modale pour visualiser le PDF -->
  <div id="pdfModal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="fermerModal()">&times;</span>
      <h2>Aper√ßu de la lettre</h2>
      <iframe id="pdfViewer" class="pdf-viewer"></iframe>
      <div class="modal-buttons">
        <button onclick="telechargerPDF()" class="btn-modal btn-download">
          üì• T√©l√©charger ce PDF
        </button>
        <button onclick="fermerModal()" class="btn-modal btn-close">
          Fermer
        </button>
      </div>
    </div>
  </div>

  <!-- Script pour g√©n√©rer la date et les fonctions PDF -->
  <script>
    // G√©n√©rer la date automatiquement
    const dateElement = document.getElementById('current-date');
    const aujourd_hui = new Date();
    const options = { year: 'numeric', month: 'long', day: 'numeric' };
    dateElement.textContent = aujourd_hui.toLocaleDateString('fr-FR', options);

    // Fonction pour g√©n√©rer le PDF
    async function genererPDF() {
      const element = document.getElementById('letterContent');
      
      // Capturer l'√©l√©ment en image
      const canvas = await html2canvas(element, {
        scale: 2,
        useCORS: true,
        backgroundColor: '#ffffff',
        logging: false
      });

      const imgData = canvas.toDataURL('image/png');
      
      // Cr√©er le PDF
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({
        orientation: 'portrait',
        unit: 'mm',
        format: 'a4'
      });

      const imgWidth = 210; // Largeur A4 en mm
      const pageHeight = 297; // Hauteur A4 en mm
      const imgHeight = (canvas.height * imgWidth) / canvas.width;
      
      pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
      
      return pdf;
    }

    // Fonction pour visualiser le PDF
    async function visualiserPDF() {
      try {
        const pdf = await genererPDF();
        const pdfBlob = pdf.output('blob');
        const pdfUrl = URL.createObjectURL(pdfBlob);
        
        // Afficher dans la modale
        document.getElementById('pdfViewer').src = pdfUrl;
        document.getElementById('pdfModal').style.display = 'flex';
      } catch (error) {
        console.error('Erreur lors de la g√©n√©ration du PDF:', error);
        alert('Erreur lors de la g√©n√©ration du PDF. Veuillez r√©essayer.');
      }
    }

    // Fonction pour t√©l√©charger le PDF
    async function telechargerPDF() {
      try {
        const pdf = await genererPDF();
        pdf.save('Lettre_Motivation_Theo_Dautrevaux.pdf');
      } catch (error) {
        console.error('Erreur lors du t√©l√©chargement:', error);
        alert('Erreur lors du t√©l√©chargement. Veuillez r√©essayer.');
      }
    }

    // Fonction pour imprimer
    function imprimerLettre() {
      window.print();
    }

    // Fonction pour fermer la modale
    function fermerModal() {
      const modal = document.getElementById('pdfModal');
      modal.style.display = 'none';
      // Nettoyer l'iframe
      document.getElementById('pdfViewer').src = '';
    }

    // Fermer la modale en cliquant en dehors
    window.onclick = function(event) {
      const modal = document.getElementById('pdfModal');
      if (event.target === modal) {
        fermerModal();
      }
    }
  </script>

  <script src="js/script.js"></script>
  
</body>
</html>